<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Check validity on big XML files with Python - iTheo.Tech</title><meta name="description" content="I wanted to check a XML file (250MB in size) but I realised that a normal editor would not really would be an option. I was thinking about Python and was about to write a piece of code to actually check big XML files. So&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://itheo.tech/check-validity-on-big-xml-files-with-python.html"><link rel="alternate" type="application/atom+xml" href="https://itheo.tech/feed.xml"><link rel="alternate" type="application/json" href="https://itheo.tech/feed.json"><meta property="og:title" content="Check validity on big XML files with Python"><meta property="og:image" content="https://itheo.tech/media/posts/63/8d77c75091b5fbb63fea4ea6e6b991fd.jpeg"><meta property="og:image:width" content="1600"><meta property="og:image:height" content="1067"><meta property="og:site_name" content="iTheo.Tech"><meta property="og:description" content="I wanted to check a XML file (250MB in size) but I realised that a normal editor would not really would be an option. I was thinking about Python and was about to write a piece of code to actually check big XML files. So&hellip;"><meta property="og:url" content="https://itheo.tech/check-validity-on-big-xml-files-with-python.html"><meta property="og:type" content="article"><link rel="stylesheet" href="https://itheo.tech/assets/css/style.css?v=6fbb1e8931a5afe843374fd67c192c86"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://itheo.tech/check-validity-on-big-xml-files-with-python.html"},"headline":"Check validity on big XML files with Python","datePublished":"2023-04-27T04:59","dateModified":"2024-06-01T19:42","image":{"@type":"ImageObject","url":"https://itheo.tech/media/posts/63/8d77c75091b5fbb63fea4ea6e6b991fd.jpeg","height":1067,"width":1600},"description":"I wanted to check a XML file (250MB in size) but I realised that a normal editor would not really would be an option. I was thinking about Python and was about to write a piece of code to actually check big XML files. So&hellip;","author":{"@type":"Person","name":"Theo van der Sluijs","url":"https://itheo.tech/authors/theo-van-der-sluijs/"},"publisher":{"@type":"Organization","name":"Theo van der Sluijs","logo":{"@type":"ImageObject","url":"https://itheo.tech/media/website/itheo.tech-500x125-logo.png","height":125,"width":500}}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript></head><body><div class="site-container"><header class="top" id="js-header"><a class="logo" href="https://itheo.tech/"><img src="https://itheo.tech/media/website/itheo.tech-500x125-logo.png" alt="iTheo.Tech" width="500" height="125"></a><div class="search"><div class="search__overlay js-search-overlay"><div class="search__overlay-inner"><button class="search__close js-search-close" aria-label="Close">Close</button></div></div><button class="search__btn js-search-btn" aria-label="Search"><svg role="presentation" focusable="false"><use xlink:href="https://itheo.tech/assets/svg/svg-map.svg#search"/></svg></button></div></header><main><article class="post"><div class="hero"><figure class="hero__image hero__image--overlay"><img src="https://itheo.tech/media/posts/63/8d77c75091b5fbb63fea4ea6e6b991fd.jpeg" srcset="https://itheo.tech/media/posts/63/responsive/8d77c75091b5fbb63fea4ea6e6b991fd-xs.webp 300w, https://itheo.tech/media/posts/63/responsive/8d77c75091b5fbb63fea4ea6e6b991fd-sm.webp 480w, https://itheo.tech/media/posts/63/responsive/8d77c75091b5fbb63fea4ea6e6b991fd-md.webp 768w, https://itheo.tech/media/posts/63/responsive/8d77c75091b5fbb63fea4ea6e6b991fd-lg.webp 1024w, https://itheo.tech/media/posts/63/responsive/8d77c75091b5fbb63fea4ea6e6b991fd-xl.webp 1360w, https://itheo.tech/media/posts/63/responsive/8d77c75091b5fbb63fea4ea6e6b991fd-2xl.webp 1600w" sizes="(max-width: 1600px) 100vw, 1600px" loading="eager" height="1067" width="1600" alt=""></figure><header class="hero__content"><div class="wrapper"><div class="post__meta"><time datetime="2023-04-27T04:59">April 27, 2023</time></div><h1>Check validity on big XML files with Python</h1><div class="post__meta post__meta--author"><img src="https://itheo.tech/media/website/64.png" loading="eager" height="512" width="512" class="post__author-thumb" alt="Theo van der Sluijs"> <a href="https://itheo.tech/authors/theo-van-der-sluijs/" class="feed__author">Theo van der Sluijs</a></div></div></header></div><div class="wrapper post__entry"><p>I wanted to check a XML file (250MB in size) but I realised that a normal editor would not really would be an option.</p><p>I was thinking about Python and was about to write a piece of code to actually check big XML files.</p><p>So the assignment is:</p><blockquote><p>Write a Python script that can check big XML files on validity. I want to be able to put in the xml and xsd file by input. The script has to show the progress of the file check process and show all problems at the end on screen and in a log file. If there is no xsd file just check the xml file without a schema.</p></blockquote><p>This script checks the validity of large XML files using the <code>lxml</code> library, which is more efficient for parsing large files than the built-in <code>xml</code> library. It shows the progress of the file check process and logs all problems at the end on screen and in a log file.</p><pre><code class="lang-python"><span class="hljs-keyword">import</span> os<restore-line-break><span class="hljs-keyword">import</span> sys<restore-line-break><span class="hljs-keyword">import</span> time<restore-line-break><span class="hljs-keyword">from</span> lxml <span class="hljs-keyword">import</span> etree<restore-line-break><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> tqdm<restore-line-break><restore-line-break><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">validate_xml_file</span>(<span class="hljs-params">xml_file, xsd_file</span>):</span><restore-line-break>    <span class="hljs-keyword">try</span>:<restore-line-break>        schema_doc = etree.parse(xsd_file)<restore-line-break>        schema = etree.XMLSchema(schema_doc)<restore-line-break>    <span class="hljs-keyword">except</span> etree.XMLSchemaParseError <span class="hljs-keyword">as</span> e:<restore-line-break>        print(<span class="hljs-string">f"Error parsing XSD schema: <span class="hljs-subst">{e}</span>"</span>)<restore-line-break>        sys.exit(<span class="hljs-number">1</span>)<restore-line-break><restore-line-break>    context = etree.iterparse(xml_file, events=(<span class="hljs-string">"start"</span>, <span class="hljs-string">"end"</span>), huge_tree=<span class="hljs-literal">True</span>)<restore-line-break>    problems = []<restore-line-break>    total_elements = <span class="hljs-number">0</span><restore-line-break><restore-line-break>    <span class="hljs-keyword">with</span> tqdm(total=os.path.getsize(xml_file), unit=<span class="hljs-string">"B"</span>, unit_scale=<span class="hljs-literal">True</span>, unit_divisor=<span class="hljs-number">1024</span>, ncols=<span class="hljs-number">100</span>) <span class="hljs-keyword">as</span> progress_bar:<restore-line-break>        <span class="hljs-keyword">try</span>:<restore-line-break>            <span class="hljs-keyword">for</span> event, elem <span class="hljs-keyword">in</span> context:<restore-line-break>                <span class="hljs-keyword">if</span> event == <span class="hljs-string">"start"</span>:<restore-line-break>                    <span class="hljs-keyword">if</span> schema.validate(elem) == <span class="hljs-literal">False</span>:<restore-line-break>                        problems.append({<span class="hljs-string">"line"</span>: elem.sourceline, <span class="hljs-string">"message"</span>: schema.error_log.last_error})<restore-line-break>                        schema.error_log.clear()<restore-line-break>                    total_elements += <span class="hljs-number">1</span><restore-line-break>                    progress_bar.update(len(etree.tostring(elem)))<restore-line-break>                elem.clear()<restore-line-break><restore-line-break>                <span class="hljs-keyword">while</span> elem.getprevious() <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<restore-line-break>                    <span class="hljs-keyword">del</span> elem.getparent()[<span class="hljs-number">0</span>]<restore-line-break>        <span class="hljs-keyword">except</span> etree.XMLSyntaxError <span class="hljs-keyword">as</span> e:<restore-line-break>            print(<span class="hljs-string">f"Error parsing XML file: <span class="hljs-subst">{e}</span>"</span>)<restore-line-break>            sys.exit(<span class="hljs-number">1</span>)<restore-line-break><restore-line-break>    <span class="hljs-keyword">return</span> problems, total_elements<restore-line-break><restore-line-break><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:<restore-line-break>    xml_file = input(<span class="hljs-string">"Enter the path to the XML file: "</span>)<restore-line-break>    xsd_file = input(<span class="hljs-string">"Enter the path to the XSD file: "</span>)<restore-line-break>    log_file = <span class="hljs-string">"xml_validation_log.txt"</span><restore-line-break><restore-line-break>    start_time = time.time()<restore-line-break>    problems, total_elements = validate_xml_file(xml_file, xsd_file)<restore-line-break>    end_time = time.time()<restore-line-break><restore-line-break>    <span class="hljs-keyword">with</span> open(log_file, <span class="hljs-string">"w"</span>) <span class="hljs-keyword">as</span> log:<restore-line-break>        log.write(<span class="hljs-string">f"Checked <span class="hljs-subst">{total_elements}</span> elements in <span class="hljs-subst">{end_time - start_time:<span class="hljs-number">.2</span>f}</span> seconds.nn"</span>)<restore-line-break>        <span class="hljs-keyword">if</span> len(problems) == <span class="hljs-number">0</span>:<restore-line-break>            log.write(<span class="hljs-string">"No problems found.n"</span>)<restore-line-break>            print(<span class="hljs-string">"No problems found."</span>)<restore-line-break>        <span class="hljs-keyword">else</span>:<restore-line-break>            log.write(<span class="hljs-string">"Problems found:n"</span>)<restore-line-break>            <span class="hljs-keyword">for</span> problem <span class="hljs-keyword">in</span> problems:<restore-line-break>                log.write(<span class="hljs-string">f"Line <span class="hljs-subst">{problem[<span class="hljs-string">'line'</span>]}</span>: <span class="hljs-subst">{problem[<span class="hljs-string">'message'</span>]}</span>n"</span>)<restore-line-break>                print(<span class="hljs-string">f"Line <span class="hljs-subst">{problem[<span class="hljs-string">'line'</span>]}</span>: <span class="hljs-subst">{problem[<span class="hljs-string">'message'</span>]}</span>"</span>)<restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></code></pre><p>Before running the script, ensure you have the <code>lxml</code> and <code>tqdm</code> libraries installed. You can install them using pip:</p><pre><code class="lang-bash">pip install lxml tqdm<restore-line-break></restore-line-break></code></pre><p>To use the script, you need to provide the path to the XML file you want to validate and the path to the XSD schema file. The script will output the progress of the file check process and will display and log any problems found. The log file will be named "xml_validation_log.txt".</p></div><footer class="wrapper post__footer"><p class="post__last-updated">This article was updated on June 1, 2024</p><div class="post__share"></div><div class="post__bio bio"><img src="https://itheo.tech/media/website/64.png" loading="lazy" height="512" width="512" class="bio__avatar" alt="Theo van der Sluijs"><div><h3 class="bio__name"><a href="https://itheo.tech/authors/theo-van-der-sluijs/" rel="author">Theo van der Sluijs</a></h3></div></div></footer></article><nav class="post__nav"><div class="post__nav-inner"><div class="post__nav-prev"><svg width="1.041em" height="0.416em" aria-hidden="true"><use xlink:href="https://itheo.tech/assets/svg/svg-map.svg#arrow-prev"/></svg> <a href="https://itheo.tech/installing-python-311-on-raspberry-pi.html" class="post__nav-link" rel="prev"><span>Previous</span> Installing Python 3.11 on Raspberry Pi</a></div><div class="post__nav-next"><a href="https://itheo.tech/pip-vs-poetry-a-comprehensive-comparison.html" class="post__nav-link" rel="next"><span>Next</span> PIP vs Poetry: A Comprehensive Comparison </a><svg width="1.041em" height="0.416em" aria-hidden="true"><use xlink:href="https://itheo.tech/assets/svg/svg-map.svg#arrow-next"/></svg></div></div></nav><div class="post__related related"><div class="wrapper"><h2 class="h5 related__title">You should also read:</h2><article class="related__item"><div class="feed__meta"><time datetime="2018-10-03T22:00" class="feed__date">October 3, 2018</time></div><h3 class="h1"><a href="https://itheo.tech/scraping-contact-data-with-python-export-to-csv.html">Scraping contact data with Python export to csv</a></h3></article><article class="related__item"><div class="feed__meta"><time datetime="2018-11-30T23:00" class="feed__date">November 30, 2018</time></div><h3 class="h1"><a href="https://itheo.tech/image-resize-python-automation-script.html">Image resize python automation script</a></h3></article><article class="related__item"><div class="feed__meta"><time datetime="2018-12-19T23:00" class="feed__date">December 19, 2018</time></div><h3 class="h1"><a href="https://itheo.tech/get-colors-from-images-python-script.html">Get colors from images python script</a></h3></article></div></div></main><footer class="footer"><div class="footer__copyright"><p>iTheo.Tech</p></div><button onclick="backToTopFunction()" id="backToTop" class="footer__bttop" aria-label="Back to top" title="Back to top"><svg><use xlink:href="https://itheo.tech/assets/svg/svg-map.svg#toparrow"/></svg></button></footer></div><script defer="defer" src="https://itheo.tech/assets/js/scripts.min.js?v=f47c11534595205f20935f0db2a62a85"></script><script>window.publiiThemeMenuConfig={mobileMenuMode:'sidebar',animationSpeed:300,submenuWidth: 'auto',doubleClickTime:500,mobileMenuExpandableSubmenus:true,relatedContainerForOverlayMenuSelector:'.top'};</script><script>var images = document.querySelectorAll('img[loading]');
        for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                images[i].classList.add('is-loaded');
            } else {
                images[i].addEventListener('load', function () {
                    this.classList.add('is-loaded');
                }, false);
            }
        }</script></body></html>