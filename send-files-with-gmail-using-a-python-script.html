<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Send files with Gmail using a python script - iTheo.Tech</title><meta name="description" content="Sending an email with this Python 3 script is very easy, but you can also send attachments with Python and Gmail. Follow this guide and have it in minutes. Now as I do not like doing stuff twice I wanted to have a script that&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://itheo.tech/send-files-with-gmail-using-a-python-script.html"><link rel="alternate" type="application/atom+xml" href="https://itheo.tech/feed.xml"><link rel="alternate" type="application/json" href="https://itheo.tech/feed.json"><meta property="og:title" content="Send files with Gmail using a python script"><meta property="og:image" content="https://itheo.tech/media/posts/39/1XMWHrBK5.jpeg"><meta property="og:image:width" content="1600"><meta property="og:image:height" content="1067"><meta property="og:site_name" content="iTheo.Tech"><meta property="og:description" content="Sending an email with this Python 3 script is very easy, but you can also send attachments with Python and Gmail. Follow this guide and have it in minutes. Now as I do not like doing stuff twice I wanted to have a script that&hellip;"><meta property="og:url" content="https://itheo.tech/send-files-with-gmail-using-a-python-script.html"><meta property="og:type" content="article"><link rel="stylesheet" href="https://itheo.tech/assets/css/style.css?v=6fbb1e8931a5afe843374fd67c192c86"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://itheo.tech/send-files-with-gmail-using-a-python-script.html"},"headline":"Send files with Gmail using a python script","datePublished":"2019-01-02T23:00","dateModified":"2024-06-01T19:42","image":{"@type":"ImageObject","url":"https://itheo.tech/media/posts/39/1XMWHrBK5.jpeg","height":1067,"width":1600},"description":"Sending an email with this Python 3 script is very easy, but you can also send attachments with Python and Gmail. Follow this guide and have it in minutes. Now as I do not like doing stuff twice I wanted to have a script that&hellip;","author":{"@type":"Person","name":"Theo van der Sluijs","url":"https://itheo.tech/authors/theo-van-der-sluijs/"},"publisher":{"@type":"Organization","name":"Theo van der Sluijs","logo":{"@type":"ImageObject","url":"https://itheo.tech/media/website/itheo.tech-500x125-logo.png","height":125,"width":500}}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript></head><body><div class="site-container"><header class="top" id="js-header"><a class="logo" href="https://itheo.tech/"><img src="https://itheo.tech/media/website/itheo.tech-500x125-logo.png" alt="iTheo.Tech" width="500" height="125"></a><div class="search"><div class="search__overlay js-search-overlay"><div class="search__overlay-inner"><button class="search__close js-search-close" aria-label="Close">Close</button></div></div><button class="search__btn js-search-btn" aria-label="Search"><svg role="presentation" focusable="false"><use xlink:href="https://itheo.tech/assets/svg/svg-map.svg#search"/></svg></button></div></header><main><article class="post"><div class="hero"><figure class="hero__image hero__image--overlay"><img src="https://itheo.tech/media/posts/39/1XMWHrBK5.jpeg" srcset="https://itheo.tech/media/posts/39/responsive/1XMWHrBK5-xs.webp 300w, https://itheo.tech/media/posts/39/responsive/1XMWHrBK5-sm.webp 480w, https://itheo.tech/media/posts/39/responsive/1XMWHrBK5-md.webp 768w, https://itheo.tech/media/posts/39/responsive/1XMWHrBK5-lg.webp 1024w, https://itheo.tech/media/posts/39/responsive/1XMWHrBK5-xl.webp 1360w, https://itheo.tech/media/posts/39/responsive/1XMWHrBK5-2xl.webp 1600w" sizes="(max-width: 1600px) 100vw, 1600px" loading="eager" height="1067" width="1600" alt=""></figure><header class="hero__content"><div class="wrapper"><div class="post__meta"><time datetime="2019-01-02T23:00">January 2, 2019</time></div><h1>Send files with Gmail using a python script</h1><div class="post__meta post__meta--author"><img src="https://itheo.tech/media/website/64.png" loading="eager" height="512" width="512" class="post__author-thumb" alt="Theo van der Sluijs"> <a href="https://itheo.tech/authors/theo-van-der-sluijs/" class="feed__author">Theo van der Sluijs</a></div></div></header></div><div class="wrapper post__entry"><p>Sending an email with this Python 3 script is very easy, but you can also send attachments with Python and Gmail. Follow this guide and have it in minutes.</p><p>Now as I do not like doing stuff twice I wanted to have a script that would send files from a folder as separate emails.</p><p>And that is exactly what this python script does. It takes a folder and for every file a mail with that file is created and send to a email address.</p><p>So I have a subscription on this online Receipt scanner service where I can scan receipts with my mobile camera and it will get processed by this service.</p><p>Now as this service is very good I also receive a lot of invoices and receipts by mail or I have to download them manually. As the service has a send to email option, sending hundreds of invoices manually to this email address is not really an option for me…. it doing something very simple more then twice! And if I have to do it twice I AUOTMATE it!</p><h2 id="heading-gmail-app-password">Gmail app Password</h2><p>Now if you are like me and want to use the Gmail service for this and you have 2-way authentication (which you REALLY shoud have!) you cannot simple start using Gmail to send these emails as Gmail wants to authenticate in a 2-way!</p><p>So when you have signed up for 2-Step Verification, Gmaikl normally sends you verification codes. However, these codes do not work with some apps and devices, like Outlook or my Python script. Instead, you’ll need to authorize the app or device the first time you use it to sign in to your Google Account by generating and entering an App password.</p><p>Creating a Google App Password is very easy.</p><ol><li>Go to your Google Account.</li><li>On the left navigation panel, click Security.</li><li><p>On the Signing in to Google panel, click App passwords. Note: If you can’t get to the page, 2-Step Verification is:</p></li><li><p>Not set up for your account</p></li><li><p>Set up for security keys only</p></li><li><p>At the bottom, click Select app and choose the app you’re using.</p></li><li>Click Select device and choose the device you’re using.</li><li>Click Generate.</li><li>Copy the the 16 character code in the yellow bar you will need it for this script.</li><li>Click Done.</li></ol><p>Once you are finished, you won’t see that App password code again. However, you will see a list of apps and devices you’ve created App passwords for.</p><h2 id="heading-mail-file-folders">Mail file folders</h2><p>To use this script save it somewhere on your pc or Mac, name it “send_files_by_gmail.py” and create a folder named “mail_files” and within this folder, and within this new “mail_files” folder create a folder named “done” and “new”.</p><p>Your folder will look like this</p><ul><li>send_files_by_gmail.py</li><li>mail_files</li><li>done</li><li>new</li></ul><p>You can place all the attachments within the “new” folder.</p><p>When the script is ready all attachments send will be in the “done” folder.</p><p>If the script crashes, you can rerun the script as it will start where it stopped as it only puts files in the “done” folder when the mail is send out.</p><h2 id="heading-how-the-python-script-works">How the python script works</h2><p>Well, very simple! You do not need to install anything. You have to use python 3 (it will not work with python 2)</p><p>You only have to fill in 3 items in the python script</p><p>your gmail email address your gmail app password and the email address your want to send it to!</p><pre><code class="lang-python"><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:<restore-line-break><restore-line-break>    from_addr = <span class="hljs-string">"some@gmail.com"</span>         <span class="hljs-comment"># your gmail account email address</span><restore-line-break>    pass_wd = <span class="hljs-string">"yourpasswors"</span>              <span class="hljs-comment"># your pwd (see discription above)</span><restore-line-break>    to_addr = <span class="hljs-string">"to@emailaddress.com"</span>     <span class="hljs-comment"># where the attachment should go to</span><restore-line-break><restore-line-break>    m = MailFiles(from_addr, pass_wd, to_addr)<restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></code></pre><p>That’s it! Have Fun!</p><pre><code class="lang-python">    <span class="hljs-string">"""<restore-line-break>    author: Theo van der Sluijs<restore-line-break>    url: https://itheo.tech<restore-line-break>    copyright: CC BY-NC 4.0<restore-line-break>    creation date: 02-01-2019<restore-line-break><restore-line-break>    Small script to send mails with attachment from folder with Gmail<restore-line-break><restore-line-break>    Uses nothing but python 3 modules.<restore-line-break><restore-line-break>    Create a folder named mail_files and within this folder done and new.<restore-line-break>    You can place all the attachments within the new folder.<restore-line-break>    When the script is ready all attachments send will be in the Done folder.<restore-line-break>    If the script crashes, you can rerun the script as it will start<restore-line-break>    where it stopped.<restore-line-break><restore-line-break>    You need an gmail app password for this to work<restore-line-break>    https://support.google.com/accounts/answer/185833?hl=en<restore-line-break>    """</restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></span><restore-line-break>    <span class="hljs-keyword">import</span> os<restore-line-break>    <span class="hljs-keyword">import</span> time<restore-line-break>    <span class="hljs-keyword">import</span> smtplib<restore-line-break><restore-line-break>    <span class="hljs-keyword">from</span> email.mime.base <span class="hljs-keyword">import</span> MIMEBase<restore-line-break>    <span class="hljs-keyword">from</span> email.mime.text <span class="hljs-keyword">import</span> MIMEText<restore-line-break>    <span class="hljs-keyword">from</span> email.mime.multipart <span class="hljs-keyword">import</span> MIMEMultipart<restore-line-break>    <span class="hljs-keyword">from</span> email <span class="hljs-keyword">import</span> encoders<restore-line-break><restore-line-break><restore-line-break>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MailFiles</span>:</span><restore-line-break>        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, from_addr=None, pass_wd=None, to_addr=None</span>):</span><restore-line-break>            <span class="hljs-string">"""<restore-line-break>            init function for this to work<restore-line-break>            :param from_addr: your gmail account email address<restore-line-break>            :param pass_wd: your gmail app pwd (see discription above)<restore-line-break>            :param to_addr: here the attachment should go to<restore-line-break>            """</restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></span><restore-line-break>            self.from_addr = from_addr<restore-line-break>            self.pass_wd = pass_wd<restore-line-break>            self.to_addr = to_addr<restore-line-break><restore-line-break>            dir_path = os.path.dirname(os.path.realpath(__file__))<restore-line-break>            self.start_dir = os.path.join(dir_path, <span class="hljs-string">"mail_files/new"</span>)<restore-line-break>            self.done_dir = os.path.join(dir_path, <span class="hljs-string">"mail_files/done"</span>)<restore-line-break><restore-line-break>            self.process_files()<restore-line-break><restore-line-break>        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">process_files</span>(<span class="hljs-params">self</span>):</span><restore-line-break>            <span class="hljs-string">"""<restore-line-break>            This will loop thru the files in the New folder and calls the<restore-line-break>            mail_file function. It has a sleep function so Gmail will not<restore-line-break>            be flooded.<restore-line-break>            """</restore-line-break></restore-line-break></restore-line-break></restore-line-break></span><restore-line-break>            i = <span class="hljs-number">1</span><restore-line-break>            <span class="hljs-keyword">for</span> filename <span class="hljs-keyword">in</span> os.listdir(self.start_dir):<restore-line-break>                file = os.path.join(self.start_dir, filename)<restore-line-break>                <span class="hljs-keyword">if</span> self.mail_file(file, filename):  <span class="hljs-comment"># Mailing retuns True or False</span><restore-line-break>                    backup_file = os.path.join(self.done_dir, filename)<restore-line-break>                    os.rename(file, backup_file)    <span class="hljs-comment"># move done file to done folder</span><restore-line-break>                print(<span class="hljs-string">"Document {} send!"</span>.format(filename))<restore-line-break>                i += <span class="hljs-number">1</span><restore-line-break>                time.sleep(<span class="hljs-number">5</span>)   <span class="hljs-comment"># Sleep for 5 seconds to not overrun Gmail</span><restore-line-break><restore-line-break>        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">mail_file</span>(<span class="hljs-params">self, file=None, filename=None</span>):</span><restore-line-break>            <span class="hljs-string">"""<restore-line-break>            This function will mail the file to the email address as an attachment<restore-line-break>            :param file: path with filename<restore-line-break>            :param filename: filename online<restore-line-break>            :return: true or false<restore-line-break>            """</restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></span><restore-line-break>            <span class="hljs-keyword">try</span>:<restore-line-break>                msg = MIMEMultipart()<restore-line-break><restore-line-break>                [<span class="hljs-string">'From'</span>] = self.from_addr<restore-line-break>                [<span class="hljs-string">'To'</span>] = self.to_addr<restore-line-break>                [<span class="hljs-string">'Subject'</span>] = <span class="hljs-string">"Sending file {}"</span>.format(filename)<restore-line-break><restore-line-break>                body = <span class="hljs-string">"Sending File {} to you"</span>.format(filename)<restore-line-break>                msg.attach(MIMEText(body, <span class="hljs-string">'plain'</span>))<restore-line-break><restore-line-break>                attachment = open(file, <span class="hljs-string">"rb"</span>)<restore-line-break><restore-line-break>                part = MIMEBase(<span class="hljs-string">'application'</span>, <span class="hljs-string">'octet-stream'</span>)<restore-line-break>                part.set_payload(attachment.read())<restore-line-break>                encoders.encode_base64(part)<restore-line-break>                part.add_header(<span class="hljs-string">'Content-Disposition'</span>, <span class="hljs-string">"attachment; filename= %s"</span> % filename)<restore-line-break><restore-line-break>                msg.attach(part)<restore-line-break><restore-line-break>                server = smtplib.SMTP(<span class="hljs-string">'smtp.gmail.com'</span>, <span class="hljs-number">587</span>)<restore-line-break>                server.starttls()<restore-line-break>                server.login(self.from_addr, self.pass_wd)<restore-line-break>                text = msg.as_string()<restore-line-break>                server.sendmail(self.from_addr, self.to_addr, text)<restore-line-break>                server.quit()<restore-line-break><restore-line-break>                <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><restore-line-break>            <span class="hljs-keyword">except</span> smtplib.SMTPException <span class="hljs-keyword">as</span> e:<restore-line-break>                print(e)<restore-line-break>                <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><restore-line-break>            <span class="hljs-keyword">except</span>:<restore-line-break>                <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><restore-line-break><restore-line-break><restore-line-break>    <span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:<restore-line-break><restore-line-break>        from_addr = <span class="hljs-string">"some@gmail.com"</span>         <span class="hljs-comment"># your gmail account email address</span><restore-line-break>        pass_wd = <span class="hljs-string">"yourpasswors"</span>              <span class="hljs-comment"># your pwd (see discription above)</span><restore-line-break>        to_addr = <span class="hljs-string">"to@emailaddress.com"</span>     <span class="hljs-comment"># where the attachment should go to</span><restore-line-break>        m = MailFiles(from_addr, pass_wd, to_addr)<restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></code></pre></div><footer class="wrapper post__footer"><p class="post__last-updated">This article was updated on June 1, 2024</p><div class="post__share"></div><div class="post__bio bio"><img src="https://itheo.tech/media/website/64.png" loading="lazy" height="512" width="512" class="bio__avatar" alt="Theo van der Sluijs"><div><h3 class="bio__name"><a href="https://itheo.tech/authors/theo-van-der-sluijs/" rel="author">Theo van der Sluijs</a></h3></div></div></footer></article><nav class="post__nav"><div class="post__nav-inner"><div class="post__nav-prev"><svg width="1.041em" height="0.416em" aria-hidden="true"><use xlink:href="https://itheo.tech/assets/svg/svg-map.svg#arrow-prev"/></svg> <a href="https://itheo.tech/fraction-calculations-in-python.html" class="post__nav-link" rel="prev"><span>Previous</span> Fraction calculations in Python</a></div><div class="post__nav-next"><a href="https://itheo.tech/get-google-analytics-pageviews-with-python.html" class="post__nav-link" rel="next"><span>Next</span> Get Google Analytics pageviews with python </a><svg width="1.041em" height="0.416em" aria-hidden="true"><use xlink:href="https://itheo.tech/assets/svg/svg-map.svg#arrow-next"/></svg></div></div></nav><div class="post__related related"><div class="wrapper"><h2 class="h5 related__title">You should also read:</h2><article class="related__item"><div class="feed__meta"><time datetime="2018-11-30T23:00" class="feed__date">November 30, 2018</time></div><h3 class="h1"><a href="https://itheo.tech/image-resize-python-automation-script.html">Image resize python automation script</a></h3></article><article class="related__item"><div class="feed__meta"><time datetime="2018-12-11T23:00" class="feed__date">December 11, 2018</time></div><h3 class="h1"><a href="https://itheo.tech/fake-jekyll-posts-generator-script.html">Fake Jekyll posts generator script</a></h3></article><article class="related__item"><div class="feed__meta"><time datetime="2018-12-19T23:00" class="feed__date">December 19, 2018</time></div><h3 class="h1"><a href="https://itheo.tech/get-colors-from-images-python-script.html">Get colors from images python script</a></h3></article></div></div></main><footer class="footer"><div class="footer__copyright"><p>iTheo.Tech</p></div><button onclick="backToTopFunction()" id="backToTop" class="footer__bttop" aria-label="Back to top" title="Back to top"><svg><use xlink:href="https://itheo.tech/assets/svg/svg-map.svg#toparrow"/></svg></button></footer></div><script defer="defer" src="https://itheo.tech/assets/js/scripts.min.js?v=f47c11534595205f20935f0db2a62a85"></script><script>window.publiiThemeMenuConfig={mobileMenuMode:'sidebar',animationSpeed:300,submenuWidth: 'auto',doubleClickTime:500,mobileMenuExpandableSubmenus:true,relatedContainerForOverlayMenuSelector:'.top'};</script><script>var images = document.querySelectorAll('img[loading]');
        for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                images[i].classList.add('is-loaded');
            } else {
                images[i].addEventListener('load', function () {
                    this.classList.add('is-loaded');
                }, false);
            }
        }</script></body></html>