<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Count your drive to work-days with Volvo Drive Log - iTheo.Tech</title><meta name="description" content="Every month comes with its routines, and if you're anything like me, you probably have a love-hate relationship with them. For me, one of those tasks was to manually count the number of days I drove to work and the number of days I worked&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://itheo.tech/count-your-drive-to-work-days-with-volvo-drive-log.html"><link rel="alternate" type="application/atom+xml" href="https://itheo.tech/feed.xml"><link rel="alternate" type="application/json" href="https://itheo.tech/feed.json"><meta property="og:title" content="Count your drive to work-days with Volvo Drive Log"><meta property="og:image" content="https://itheo.tech/media/posts/81/77fcbb262160719fe3b29b16070ff520.jpeg"><meta property="og:image:width" content="1600"><meta property="og:image:height" content="1063"><meta property="og:site_name" content="iTheo.Tech"><meta property="og:description" content="Every month comes with its routines, and if you're anything like me, you probably have a love-hate relationship with them. For me, one of those tasks was to manually count the number of days I drove to work and the number of days I worked&hellip;"><meta property="og:url" content="https://itheo.tech/count-your-drive-to-work-days-with-volvo-drive-log.html"><meta property="og:type" content="article"><link rel="stylesheet" href="https://itheo.tech/assets/css/style.css?v=6fbb1e8931a5afe843374fd67c192c86"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://itheo.tech/count-your-drive-to-work-days-with-volvo-drive-log.html"},"headline":"Count your drive to work-days with Volvo Drive Log","datePublished":"2023-10-03T17:55","dateModified":"2024-06-01T19:42","image":{"@type":"ImageObject","url":"https://itheo.tech/media/posts/81/77fcbb262160719fe3b29b16070ff520.jpeg","height":1063,"width":1600},"description":"Every month comes with its routines, and if you're anything like me, you probably have a love-hate relationship with them. For me, one of those tasks was to manually count the number of days I drove to work and the number of days I worked&hellip;","author":{"@type":"Person","name":"Theo van der Sluijs","url":"https://itheo.tech/authors/theo-van-der-sluijs/"},"publisher":{"@type":"Organization","name":"Theo van der Sluijs","logo":{"@type":"ImageObject","url":"https://itheo.tech/media/website/itheo.tech-500x125-logo.png","height":125,"width":500}}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript></head><body><div class="site-container"><header class="top" id="js-header"><a class="logo" href="https://itheo.tech/"><img src="https://itheo.tech/media/website/itheo.tech-500x125-logo.png" alt="iTheo.Tech" width="500" height="125"></a><div class="search"><div class="search__overlay js-search-overlay"><div class="search__overlay-inner"><button class="search__close js-search-close" aria-label="Close">Close</button></div></div><button class="search__btn js-search-btn" aria-label="Search"><svg role="presentation" focusable="false"><use xlink:href="https://itheo.tech/assets/svg/svg-map.svg#search"/></svg></button></div></header><main><article class="post"><div class="hero"><figure class="hero__image hero__image--overlay"><img src="https://itheo.tech/media/posts/81/77fcbb262160719fe3b29b16070ff520.jpeg" srcset="https://itheo.tech/media/posts/81/responsive/77fcbb262160719fe3b29b16070ff520-xs.webp 300w, https://itheo.tech/media/posts/81/responsive/77fcbb262160719fe3b29b16070ff520-sm.webp 480w, https://itheo.tech/media/posts/81/responsive/77fcbb262160719fe3b29b16070ff520-md.webp 768w, https://itheo.tech/media/posts/81/responsive/77fcbb262160719fe3b29b16070ff520-lg.webp 1024w, https://itheo.tech/media/posts/81/responsive/77fcbb262160719fe3b29b16070ff520-xl.webp 1360w, https://itheo.tech/media/posts/81/responsive/77fcbb262160719fe3b29b16070ff520-2xl.webp 1600w" sizes="(max-width: 1600px) 100vw, 1600px" loading="eager" height="1063" width="1600" alt=""></figure><header class="hero__content"><div class="wrapper"><div class="post__meta"><time datetime="2023-10-03T17:55">October 3, 2023</time></div><h1>Count your drive to work-days with Volvo Drive Log</h1><div class="post__meta post__meta--author"><img src="https://itheo.tech/media/website/64.png" loading="eager" height="512" width="512" class="post__author-thumb" alt="Theo van der Sluijs"> <a href="https://itheo.tech/authors/theo-van-der-sluijs/" class="feed__author">Theo van der Sluijs</a></div></div></header></div><div class="wrapper post__entry"><p>Every month comes with its routines, and if you're anything like me, you probably have a love-hate relationship with them. For me, one of those tasks was to manually count the number of days I drove to work and the number of days I worked from home. But you know what? I thought to myself: Why not spend time automating this? After all, I own a Volvo V60 that's capable of giving me an excellent log of my trips. So, I decided to write a Python script that does the heavy lifting for me, and now I can focus on the fun stuff—like figuring out how to get my Volvo's API to directly sync with the script.</p><h2 id="heading-why-i-needed-to-automate-this">Why I Needed to Automate This</h2><p>You might be wondering why this is such a big deal. I mean, it's just a matter of counting days, right? Well, the problem is not the complexity but the repetition of the task. Doing the same manual counting task 12 times a year feels a bit too much like Groundhog Day. Plus, we are living in the 21st century—automation is the name of the game. So, I dived into the Volvo Drive Log and my Python IDE and got to work.</p><h2 id="heading-the-script-python-to-the-rescue">The Script: Python to the Rescue</h2><p>Before we delve into the details, let me say that Python was an obvious choice for this project. Given its simplicity and a rich ecosystem of libraries, I could easily read Excel files, manipulate data, and even count business days in a given month.</p><p>Here's how the script works:</p><h3 id="heading-importing-libraries">Importing Libraries</h3><pre><code class="lang-python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<restore-line-break><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<restore-line-break><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime<restore-line-break><span class="hljs-keyword">from</span> dateutil <span class="hljs-keyword">import</span> relativedelta<restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></code></pre><p>In this section, I imported the required libraries. <code>pandas</code> is used for data manipulation, <code>numpy</code> for numerical operations, and <code>datetime</code> for date-time manipulations.</p><h3 id="heading-function-finddatesfromeindpunt">Function: <code>find_dates_from_eindpunt</code></h3><p>This is the heart of the script, where most of the logic resides.</p><pre><code class="lang-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">find_dates_from_eindpunt</span>(<span class="hljs-params">excel_path, eindpunt_value=<span class="hljs-string">"Oude Veerseweg"</span>, eindpunt_col=<span class="hljs-string">"Eindpunt"</span>, datetime_col=<span class="hljs-string">"Begonnen"</span></span>):</span><restore-line-break></restore-line-break></code></pre><p>Here, I defined the function that takes several parameters:</p><ul><li><p><code>excel_path</code>: The path to the Excel file containing the log.</p></li><li><p><code>eindpunt_value</code>: The value to search for in the 'Eindpunt' column.</p></li><li><p><code>eindpunt_col</code>: The name of the column where we'll search for <code>eindpunt_value</code>.</p></li><li><p><code>datetime_col</code>: The name of the column containing the date-time strings.</p></li></ul><h4 id="heading-reading-the-excel-file">Reading the Excel File</h4><pre><code class="lang-python">df = pd.read_excel(excel_path)<restore-line-break></restore-line-break></code></pre><p>With <code>pandas</code>, reading an Excel file is as simple as this one-liner.</p><h4 id="heading-filtering-rows">Filtering Rows</h4><pre><code class="lang-python">filtered_df = df[df[eindpunt_col].str.contains(eindpunt_value, case=<span class="hljs-literal">False</span>, na=<span class="hljs-literal">False</span>)]<restore-line-break></restore-line-break></code></pre><p>Here, we filter the rows where the 'Eindpunt' column contains the word "Oude Veerseweg."</p><h4 id="heading-checking-for-multiple-months">Checking for Multiple Months</h4><pre><code class="lang-python">months_set = set(str(date).split(<span class="hljs-string">"-"</span>)[<span class="hljs-number">1</span>] <span class="hljs-keyword">for</span> date <span class="hljs-keyword">in</span> dates_set)<restore-line-break></restore-line-break></code></pre><p>This part checks if the data contains entries from multiple months and prints a warning if it does.</p><h3 id="heading-the-main-program">The Main Program</h3><p>In the <code>main</code> section of the code, we take user input for the <code>eindpunt_value</code> and the number of days off. Then, we call the <code>find_dates_from_eindpunt</code> function and print out the results.</p><h2 id="heading-using-the-script">Using the Script</h2><p>Using the script is easy-peasy! Place your Excel file in the right directory, run the script, and answer the prompts. Voila! You'll have your count of days you drove to work, days you worked from home, and even days you took off.</p><h2 id="heading-future-plans">Future Plans</h2><p>The next big thing on my agenda is to integrate this script with the Volvo API, so I won't even have to download the Excel file manually. A fully automated system is the dream, after all.</p><h2 id="heading-heres-the-entire-script-for-your-reference">Here's the Entire Script for Your Reference</h2><pre><code class="lang-python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<restore-line-break><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<restore-line-break><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime<restore-line-break><span class="hljs-keyword">from</span> dateutil <span class="hljs-keyword">import</span> relativedelta<restore-line-break><restore-line-break><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">find_dates_from_eindpunt</span>(<span class="hljs-params">excel_path, eindpunt_value=<span class="hljs-string">"Oude Veerseweg"</span>, eindpunt_col=<span class="hljs-string">"Eindpunt"</span>, datetime_col=<span class="hljs-string">"Begonnen"</span></span>):</span><restore-line-break>    df = pd.read_excel(excel_path)<restore-line-break>    filtered_df = df[df[eindpunt_col].str.contains(eindpunt_value, case=<span class="hljs-literal">False</span>, na=<span class="hljs-literal">False</span>)]<restore-line-break>    dates_set = set(str(date).split(<span class="hljs-string">" "</span>)[<span class="hljs-number">0</span>] <span class="hljs-keyword">for</span> date <span class="hljs-keyword">in</span> filtered_df[datetime_col].to_list())<restore-line-break>    months_set = set(str(date).split(<span class="hljs-string">"-"</span>)[<span class="hljs-number">1</span>] <span class="hljs-keyword">for</span> date <span class="hljs-keyword">in</span> dates_set)<restore-line-break>    <span class="hljs-keyword">if</span> len(months_set) > <span class="hljs-number">1</span>:<restore-line-break>        print(<span class="hljs-string">"Warning: More than one month found in the data. Please be cautious."</span>)<restore-line-break>    sorted_dates = sorted(dates_set)<restore-line-break>    business_days_count = <span class="hljs-number">0</span><restore-line-break>    <span class="hljs-keyword">if</span> sorted_dates:<restore-line-break>        first_date = datetime.strptime(sorted_dates[<span class="hljs-number">0</span>], <span class="hljs-string">'%Y-%m-%d'</span>)<restore-line-break>        last_date = datetime.strptime(sorted_dates[<span class="hljs-number">-1</span>], <span class="hljs-string">'%Y-%m-%d'</span>)<restore-line-break>        month_name = first_date.strftime(<span class="hljs-string">"%B"</span>)<restore-line-break>        business_days_count = np.busday_count(sorted_dates[<span class="hljs-number">0</span>], sorted_dates[<span class="hljs-number">-1</span>]) + <span class="hljs-number">1</span><restore-line-break>        adjusted_count = business_days_count - len(sorted_dates)<restore-line-break>        <span class="hljs-keyword">return</span> sorted_dates, adjusted_count, business_days_count, month_name<restore-line-break>    <span class="hljs-keyword">else</span>:<restore-line-break>        <span class="hljs-keyword">return</span> [], <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-string">""</span><restore-line-break><restore-line-break><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:<restore-line-break>    excel_path = <span class="hljs-string">"data/volvo-journal-log.xlsx"</span><restore-line-break>    eindpunt_value = input(<span class="hljs-string">"Enter the value to search for in the 'Eindpunt' column (default is 'Oude Veerseweg'): "</span>)<restore-line-break>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> eindpunt_value:<restore-line-break>        eindpunt_value = <span class="hljs-string">"Oude Veerseweg"</span><restore-line-break>    days_off_input = input(<span class="hljs-string">"Enter the number of days off you had (default is 0): "</span>)<restore-line-break>    days_off = int(days_off_input) <span class="hljs-keyword">if</span> days_off_input <span class="hljs-keyword">else</span> <span class="hljs-number">0</span><restore-line-break>    dates, adjusted_count, business_days_count, month_name = find_dates_from_eindpunt(excel_path, eindpunt_value=eindpunt_value)<restore-line-break>    adjusted_count -= days_off<restore-line-break>    <span class="hljs-keyword">for</span> date <span class="hljs-keyword">in</span> dates:<restore-line-break>        print(date)<restore-line-break>    print(<span class="hljs-string">f"Total days you drove to work in <span class="hljs-subst">{month_name}</span>: <span class="hljs-subst">{len(dates)}</span>"</span>)<restore-line-break>    print(<span class="hljs-string">f"Actual number of working days in <span class="hljs-subst">{month_name}</span>: <span class="hljs-subst">{business_days_count}</span>"</span>)<restore-line-break>    print(<span class="hljs-string">f"Total number of days you worked from home: <span class="hljs-subst">{adjusted_count}</span>"</span>)<restore-line-break>    print(<span class="hljs-string">f"Total number of days off: <span class="hljs-subst">{days_off}</span>"</span>)<restore-line-break>    print(<span class="hljs-string">"If you had any additional off days during this period please subtract them yourself."</span>)<restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></code></pre></div><footer class="wrapper post__footer"><p class="post__last-updated">This article was updated on June 1, 2024</p><div class="post__share"></div><div class="post__bio bio"><img src="https://itheo.tech/media/website/64.png" loading="lazy" height="512" width="512" class="bio__avatar" alt="Theo van der Sluijs"><div><h3 class="bio__name"><a href="https://itheo.tech/authors/theo-van-der-sluijs/" rel="author">Theo van der Sluijs</a></h3></div></div></footer></article><nav class="post__nav"><div class="post__nav-inner"><div class="post__nav-prev"><svg width="1.041em" height="0.416em" aria-hidden="true"><use xlink:href="https://itheo.tech/assets/svg/svg-map.svg#arrow-prev"/></svg> <a href="https://itheo.tech/upgrading-to-python-312-on-your-raspberry-pi.html" class="post__nav-link" rel="prev"><span>Previous</span> Upgrading to Python 3.12 on Your Raspberry Pi</a></div><div class="post__nav-next"><a href="https://itheo.tech/creating-a-dynamic-product-screen-in-wordpress-woocommerce.html" class="post__nav-link" rel="next"><span>Next</span> Creating a Dynamic Product Screen in WordPress WooCommerce </a><svg width="1.041em" height="0.416em" aria-hidden="true"><use xlink:href="https://itheo.tech/assets/svg/svg-map.svg#arrow-next"/></svg></div></div></nav><div class="post__related related"><div class="wrapper"><h2 class="h5 related__title">You should also read:</h2><article class="related__item"><div class="feed__meta"><time datetime="2015-02-05T19:42" class="feed__date">February 5, 2015</time></div><h3 class="h1"><a href="https://itheo.tech/url-shortener-with-php-and-mongodb-script.html">Url shortener with PHP and MongoDB script</a></h3></article><article class="related__item"><div class="feed__meta"><time datetime="2015-08-11T11:52" class="feed__date">August 11, 2015</time></div><h3 class="h1"><a href="https://itheo.tech/better-mongodb-backup-script-with-tar-and-move-to-s3-bucket.html">Better MongoDB backup script with Tar and move to S3 Bucket</a></h3></article><article class="related__item"><div class="feed__meta"><time datetime="2018-03-18T12:35" class="feed__date">March 18, 2018</time></div><h3 class="h1"><a href="https://itheo.tech/using-ubuntu-on-windows-10-without-admin-rights.html">Using Ubuntu on Windows 10 without Admin Rights</a></h3></article></div></div></main><footer class="footer"><div class="footer__copyright"><p>iTheo.Tech</p></div><button onclick="backToTopFunction()" id="backToTop" class="footer__bttop" aria-label="Back to top" title="Back to top"><svg><use xlink:href="https://itheo.tech/assets/svg/svg-map.svg#toparrow"/></svg></button></footer></div><script defer="defer" src="https://itheo.tech/assets/js/scripts.min.js?v=f47c11534595205f20935f0db2a62a85"></script><script>window.publiiThemeMenuConfig={mobileMenuMode:'sidebar',animationSpeed:300,submenuWidth: 'auto',doubleClickTime:500,mobileMenuExpandableSubmenus:true,relatedContainerForOverlayMenuSelector:'.top'};</script><script>var images = document.querySelectorAll('img[loading]');
        for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                images[i].classList.add('is-loaded');
            } else {
                images[i].addEventListener('load', function () {
                    this.classList.add('is-loaded');
                }, false);
            }
        }</script></body></html>