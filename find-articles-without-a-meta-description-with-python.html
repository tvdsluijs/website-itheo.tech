<!DOCTYPE html>
<html lang="en-gb">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
            <title>Find articles without  a meta description with python - iTheo.Tech </title>
        <meta name="description" content="So I have been writing a lot of blog posts on Hashnode. I really love the environment and its cheaper faster and better than a good Wordpress site. But I sometimes forget to do write some good SEO descriptions. Most of the time I forget&hellip;" />
         
        <meta name="generator" content="Publii Open-Source CMS for Static Site" />

        <link rel="canonical" href="https://itheo.tech/find-articles-without-a-meta-description-with-python.html">
        <link rel="alternate" type="application/atom+xml" href="https://itheo.tech/feed.xml" />
<link rel="alternate" type="application/json" href="https://itheo.tech/feed.json" />

        <meta property="og:title" content="Find articles without  a meta description with python" /><meta property="og:image" content="https://itheo.tech/media/posts/61/8b59a514c21d21d9d108d02683633eba.jpeg"/><meta property="og:image:width" content="1600" /><meta property="og:image:height" content="1067" /><meta property="og:site_name" content="iTheo.Tech" /><meta property="og:description" content="So I have been writing a lot of blog posts on Hashnode. I really love the environment and its cheaper faster and better than a good Wordpress site. But I sometimes forget to do write some good SEO descriptions. Most of the time I forget&hellip;" /><meta property="og:url" content="https://itheo.tech/find-articles-without-a-meta-description-with-python.html" /><meta property="og:type" content="article" />
        <link rel="stylesheet" href="https://itheo.tech/assets/css/style.css?v=6fbb1e8931a5afe843374fd67c192c86">
        <script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://itheo.tech/find-articles-without-a-meta-description-with-python.html"},"headline":"Find articles without  a meta description with python","datePublished":"2023-04-29T06:18","dateModified":"2024-06-01T19:42","image":{"@type":"ImageObject","url":"https://itheo.tech/media/posts/61/8b59a514c21d21d9d108d02683633eba.jpeg","height":1067,"width":1600},"description":"So I have been writing a lot of blog posts on Hashnode. I really love the environment and its cheaper faster and better than a good Wordpress site. But I sometimes forget to do write some good SEO descriptions. Most of the time I forget&hellip;","author":{"@type":"Person","name":"Theo van der Sluijs","url":"https://itheo.tech/authors/theo-van-der-sluijs/"},"publisher":{"@type":"Organization","name":"Theo van der Sluijs","logo":{"@type":"ImageObject","url":"https://itheo.tech/media/website/itheo.tech-500x125-logo.png","height":125,"width":500}}}</script>
        
        <noscript>
            <style>
                img[loading] {
                    opacity: 1;
                }
            </style>
        </noscript>	
        
    </head>
    <body>
        <div class="site-container">
   <header class="top" id="js-header">
      <a class="logo" href="https://itheo.tech/">
            <img src="https://itheo.tech/media/website/itheo.tech-500x125-logo.png" alt="iTheo.Tech" width="500" height="125">
      </a>
         <div class="search">
            <div class="search__overlay js-search-overlay">
               <div class="search__overlay-inner">
                   
                  <button class="search__close js-search-close" aria-label="Close">
                     Close
                  </button>
               </div>
            </div>
            <button class="search__btn js-search-btn" aria-label="Search">
               <svg role="presentation" focusable="false">
                  <use xlink:href="https://itheo.tech/assets/svg/svg-map.svg#search"/>
               </svg>
            </button>
         </div>
   </header>
<main>
      <article class="post">
         <div class="hero">
             
                  <figure class="hero__image hero__image--overlay">                      
                     <img
                        src="https://itheo.tech/media/posts/61/8b59a514c21d21d9d108d02683633eba.jpeg"
                            srcset="https://itheo.tech/media/posts/61/responsive/8b59a514c21d21d9d108d02683633eba-xs.webp 300w ,https://itheo.tech/media/posts/61/responsive/8b59a514c21d21d9d108d02683633eba-sm.webp 480w ,https://itheo.tech/media/posts/61/responsive/8b59a514c21d21d9d108d02683633eba-md.webp 768w ,https://itheo.tech/media/posts/61/responsive/8b59a514c21d21d9d108d02683633eba-lg.webp 1024w ,https://itheo.tech/media/posts/61/responsive/8b59a514c21d21d9d108d02683633eba-xl.webp 1360w ,https://itheo.tech/media/posts/61/responsive/8b59a514c21d21d9d108d02683633eba-2xl.webp 1600w" sizes="(max-width: 1600px) 100vw, 1600px"
                         loading="eager"
                        height="1067"
                        width="1600"
                        alt="">
                      
                  </figure>
             
            <header class="hero__content">
               <div class="wrapper">
                     <div class="post__meta">
                        <time datetime="2023-04-29T06:18">
                              April 29, 2023
                        </time>
                     </div>
                  <h1>
                     Find articles without  a meta description with python
                  </h1>
                     <div class="post__meta post__meta--author">
                              <img 
                                 src="https://itheo.tech/media/website/64.png" 
                                  loading="eager"
                                 height="512"
                                 width="512"
                                 class="post__author-thumb" 
                                 alt="Theo van der Sluijs">
                           <a href="https://itheo.tech/authors/theo-van-der-sluijs/" class="feed__author">Theo van der Sluijs</a>
                     </div>
               </div>
            </header>
         </div>

         <div class="wrapper post__entry">           
            <p>So I have been writing a lot of blog posts on Hashnode. I really love the environment and its cheaper faster and better than a good Wordpress site.</p>
<p>But I sometimes forget to do write some good SEO descriptions. Most of the time I forget it completely.</p>
<p>But to check every article by hand is a bit to much work. I love to automate shit right?</p>
<p>So this is the assignment:</p>
<blockquote>
<p>Write a Python script that takes a website URL as input, recursively scans all its content pages, and saves the URLs with missing meta descriptions or meta descriptions shorter than 100 characters in an Excel file. Use Poetry as a tool for dependency management and packaging, and write tests with the unittest library.</p>
</blockquote>
<p>To get started, first install Poetry using the instructions provided on the official website: <a target="_blank" href="https://python-poetry.org/docs/#installation" rel="noopener">https://python-poetry.org/docs/#installation</a></p>
<p>Create a new project folder and navigate to it in the terminal:</p>
<pre><code class="lang-bash">mkdir website_crawler<restore-line-break><span class="hljs-built_in">cd</span> website_crawler<restore-line-break></code></pre>
<p>Initialize the project with Poetry:</p>
<pre><code class="lang-bash">poetry init<restore-line-break></code></pre>
<p>Add the required dependencies (requests, beautifulsoup4, openpyxl) using Poetry:</p>
<pre><code class="lang-bash">poetry add requests beautifulsoup4 openpyxl<restore-line-break></code></pre>
<p>Create the <code>website_crawler</code> folder, which will contain the main script:</p>
<pre><code class="lang-bash">mkdir website_crawler<restore-line-break></code></pre>
<p>Inside the <code>website_crawler</code> folder, create the <code>__init__.py</code> file to make it a Python package:</p>
<pre><code class="lang-bash">touch website_crawler/__init__.py<restore-line-break></code></pre>
<p>Create the <a target="_blank" href="http://crawler.py" rel="noopener"><code>crawler.py</code></a> file inside the <code>website_crawler</code> folder and add the following code:</p>
<pre><code class="lang-python"><span class="hljs-comment"># website_crawler/crawler.py</span><restore-line-break><restore-line-break><span class="hljs-keyword">import</span> requests<restore-line-break><span class="hljs-keyword">from</span> bs4 <span class="hljs-keyword">import</span> BeautifulSoup<restore-line-break><span class="hljs-keyword">from</span> openpyxl <span class="hljs-keyword">import</span> Workbook<restore-line-break><span class="hljs-keyword">from</span> urllib.parse <span class="hljs-keyword">import</span> urljoin, urlparse<restore-line-break><restore-line-break><restore-line-break><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">extract_links</span>(<span class="hljs-params">url, soup</span>):</span><restore-line-break>    <span class="hljs-string">"""Extract internal links on the given page and return them as a list of absolute URLs."""</span><restore-line-break>    links = [a.get(<span class="hljs-string">"href"</span>) <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> soup.find_all(<span class="hljs-string">"a"</span>, href=<span class="hljs-literal">True</span>)]<restore-line-break>    absolute_links = [urljoin(url, link) <span class="hljs-keyword">for</span> link <span class="hljs-keyword">in</span> links <span class="hljs-keyword">if</span> urlparse(urljoin(url, link)).netloc == urlparse(url).netloc]<restore-line-break>    <span class="hljs-keyword">return</span> absolute_links<restore-line-break><restore-line-break><restore-line-break><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">check_meta_description</span>(<span class="hljs-params">url</span>):</span><restore-line-break>    <span class="hljs-string">"""Check if the meta description is missing or shorter than 100 characters."""</span><restore-line-break>    response = requests.get(url)<restore-line-break>    soup = BeautifulSoup(response.text, <span class="hljs-string">"html.parser"</span>)<restore-line-break>    meta_description = soup.find(<span class="hljs-string">"meta"</span>, attrs={<span class="hljs-string">"name"</span>: <span class="hljs-string">"description"</span>})<restore-line-break>    <span class="hljs-keyword">return</span> meta_description <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">or</span> len(meta_description[<span class="hljs-string">"content"</span>]) < <span class="hljs-number">100</span><restore-line-break><restore-line-break><restore-line-break><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">crawl_website</span>(<span class="hljs-params">url</span>):</span><restore-line-break>    <span class="hljs-string">"""Crawl the website recursively and return a list of URLs with missing or short meta descriptions."""</span><restore-line-break>    visited = set()<restore-line-break>    missing_meta_description = []<restore-line-break><restore-line-break>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">visit_page</span>(<span class="hljs-params">url</span>):</span><restore-line-break>        <span class="hljs-keyword">nonlocal</span> visited, missing_meta_description<restore-line-break>        <span class="hljs-keyword">if</span> url <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> visited:<restore-line-break>            visited.add(url)<restore-line-break>            <span class="hljs-keyword">if</span> check_meta_description(url):<restore-line-break>                missing_meta_description.append(url)<restore-line-break>            soup = BeautifulSoup(requests.get(url).text, <span class="hljs-string">"html.parser"</span>)<restore-line-break>            links = extract_links(url, soup)<restore-line-break>            <span class="hljs-keyword">for</span> link <span class="hljs-keyword">in</span> links:<restore-line-break>                visit_page(link)<restore-line-break><restore-line-break>    visit_page(url)<restore-line-break>    <span class="hljs-keyword">return</span> missing_meta_description<restore-line-break><restore-line-break><restore-line-break><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">save_to_excel</span>(<span class="hljs-params">urls, output_file</span>):</span><restore-line-break>    <span class="hljs-string">"""Save the list of URLs to an Excel file."""</span><restore-line-break>    wb = Workbook()<restore-line-break>    ws = wb.active<restore-line-break>    ws.append([<span class="hljs-string">"URL"</span>])<restore-line-break>    <span class="hljs-keyword">for</span> url <span class="hljs-keyword">in</span> urls:<restore-line-break>        ws.append([url])<restore-line-break>    wb.save(output_file)<restore-line-break></code></pre>
<p>Now, let's create the <a target="_blank" href="http://main.py" rel="noopener"><code>main.py</code></a> file inside the <code>website_crawler</code> folder:</p>
<pre><code class="lang-python"><span class="hljs-comment"># website_crawler/main.py</span><restore-line-break><restore-line-break><span class="hljs-keyword">import</span> sys<restore-line-break><span class="hljs-keyword">from</span> .crawler <span class="hljs-keyword">import</span> crawl_website, save_to_excel<restore-line-break><restore-line-break><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>():</span><restore-line-break>    <span class="hljs-keyword">if</span> len(sys.argv) < <span class="hljs-number">3</span>:<restore-line-break>        print(<span class="hljs-string">"Usage: python -m website_crawler WEBSITE_URL OUTPUT_FILE"</span>)<restore-line-break>        sys.exit(<span class="hljs-number">1</span>)<restore-line-break><restore-line-break>    website_url = sys.argv[<span class="hljs-number">1</span>]<restore-line-break>    output_file = sys.argv[<span class="hljs-number">2</span>]<restore-line-break><restore-line-break>    urls_missing_meta_description = crawl_website(website_url)<restore-line-break>    save_to_excel(urls_missing_meta_description, output_file)<restore-line-break><restore-line-break>    print(<span class="hljs-string">f"URLs with missing or short meta descriptions saved in <span class="hljs-subst">{output_file}</span>"</span>)<restore-line-break><restore-line-break><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:<restore-line-break>    main()<restore-line-break></code></pre>
<p>Now, let's create a <code>tests</code> folder and a <code>test_crawler.py</code> file inside it:</p>
<pre><code class="lang-bash">mkdir tests<restore-line-break>touch tests/test_crawler.py<restore-line-break></code></pre>
<p>Add the following test code to <code>tests/test_crawler.py</code>:</p>
<pre><code class="lang-python"><span class="hljs-comment"># tests/test_crawler.py</span><restore-line-break><restore-line-break><span class="hljs-keyword">import</span> unittest<restore-line-break><span class="hljs-keyword">from</span> website_crawler.crawler <span class="hljs-keyword">import</span> extract_links, check_meta_description<restore-line-break><restore-line-break><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestCrawler</span>(<span class="hljs-params">unittest.TestCase</span>):</span><restore-line-break><restore-line-break>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test_extract_links</span>(<span class="hljs-params">self</span>):</span><restore-line-break>        html = <span class="hljs-string">"""<restore-line-break>        <html><restore-line-break>            <body><restore-line-break>                <a href="/page1">Page 1</a><restore-line-break>                <a href="/page2">Page 2</a><restore-line-break>                <a href="https://external.com/page">External</a><restore-line-break>            </body><restore-line-break>        </html><restore-line-break>        """</span><restore-line-break>        soup = BeautifulSoup(html, <span class="hljs-string">"html.parser"</span>)<restore-line-break>        links = extract_links(<span class="hljs-string">"https://example.com"</span>, soup)<restore-line-break>        expected_links = [<span class="hljs-string">"https://example.com/page1"</span>, <span class="hljs-string">"https://example.com/page2"</span>]<restore-line-break>        self.assertEqual(links, expected_links)<restore-line-break><restore-line-break>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test_check_meta_description</span>(<span class="hljs-params">self</span>):</span><restore-line-break>        html_missing = <span class="hljs-string">"""<restore-line-break>        <html><restore-line-break>            <head></head><restore-line-break>            <body></body><restore-line-break>        </html><restore-line-break>        """</span><restore-line-break>        html_short = <span class="hljs-string">"""<restore-line-break>        <html><restore-line-break>            <head><restore-line-break>                <meta name="description" content="Short description"><restore-line-break>            </head><restore-line-break>            <body></body><restore-line-break>        </html><restore-line-break>        """</span><restore-line-break>        html_long = <span class="hljs-string">"""<restore-line-break>        <html><restore-line-break>            <head><restore-line-break>                <meta name="description" content="This is a long description that is more than 100 characters long, so it should not be considered as short."><restore-line-break>            </head><restore-line-break>            <body></body><restore-line-break>        </html><restore-line-break>        """</span><restore-line-break>        self.assertTrue(check_meta_description(BeautifulSoup(html_missing, <span class="hljs-string">"html.parser"</span>)))<restore-line-break>        self.assertTrue(check_meta_description(BeautifulSoup(html_short, <span class="hljs-string">"html.parser"</span>)))<restore-line-break>        self.assertFalse(check_meta_description(BeautifulSoup(html_long, <span class="hljs-string">"html.parser"</span>)))<restore-line-break><restore-line-break><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:<restore-line-break>    unittest.main()<restore-line-break></code></pre>
<p>Finally, to run the tests, execute the following command in the terminal:</p>
<pre><code class="lang-bash">poetry run python -m unittest discover tests<restore-line-break></code></pre>
<p>To run the main script, use the following command:</p>
<pre><code class="lang-bash">poetry run python -m website_crawler WEBSITE_URL OUTPUT_FILE<restore-line-break></code></pre>
<p>In summary, the script consists of the following functions:</p>
<ul>
<li>
<p><code>extract_links(url, soup)</code>: Extracts all internal links from a given page and returns them as a list of absolute URLs.</p>
</li>
<li>
<p><code>check_meta_description(url)</code>: Checks if a meta description is missing or shorter than 100 characters.</p>
</li>
<li>
<p><code>crawl_website(url)</code>: Recursively crawls a website and returns a list of URLs with missing or short meta descriptions.</p>
</li>
<li>
<p><code>save_to_excel(urls, output_file)</code>: Saves the list of URLs to an Excel file.</p>
</li>
</ul>
<p>The test suite in <code>tests/test_crawler.py</code> contains tests for <code>extract_links</code> and <code>check_meta_description</code> functions.</p>


            
         </div>

            <footer class="wrapper post__footer">

                     <p class="post__last-updated">
                        This article was updated on
                           June 1, 2024
                     </p>


                     <div class="post__share">
                        
                        
                        
                        
                        
                        
                     </div>

                  <div class="post__bio bio">
                           <img 
                              src="https://itheo.tech/media/website/64.png" 
                               loading="lazy"
                              height="512"
                              width="512" 
                              class="bio__avatar" 
                              alt="Theo van der Sluijs">                          
                        <div>
                           <h3 class="bio__name">
                              <a href="https://itheo.tech/authors/theo-van-der-sluijs/" rel="author">Theo van der Sluijs</a>
                           </h3>
                        </div>
                  </div>
            </footer>
      </article>

            <nav class="post__nav">
               <div class="post__nav-inner">
                     <div class="post__nav-prev">
                        <svg width="1.041em" height="0.416em" aria-hidden="true">
                           <use xlink:href="https://itheo.tech/assets/svg/svg-map.svg#arrow-prev"/>
                        </svg>

                        <a href="https://itheo.tech/pip-vs-poetry-a-comprehensive-comparison.html" class="post__nav-link" rel="prev">
                           <span>Previous</span>
                           PIP vs Poetry: A Comprehensive Comparison
                        </a>
                     </div>
                     <div class="post__nav-next">
                        <a href="https://itheo.tech/enable-recaptcha-on-woocommerce-reviews.html" class="post__nav-link" rel="next">
                           <span>Next</span>
                           Enable reCAPTCHA on WooCommerce Reviews
                        </a>
                        <svg width="1.041em" height="0.416em" aria-hidden="true">
                           <use xlink:href="https://itheo.tech/assets/svg/svg-map.svg#arrow-next"/>
                        </svg>
                     </div>
               </div>
            </nav>

            <div class="post__related related">
               <div class="wrapper">
                  <h2 class="h5 related__title">
                     You should also read:
                  </h2>
                     <article class="related__item">
                        <div class="feed__meta">
                           <time datetime="2018-10-03T22:00" class="feed__date">
                                 October 3, 2018
                           </time>
                        </div>
                        <h3 class="h1">
                           <a href="https://itheo.tech/scraping-contact-data-with-python-export-to-csv.html">
                              Scraping contact data with Python export to csv
                           </a>
                        </h3>
                     </article>
                     <article class="related__item">
                        <div class="feed__meta">
                           <time datetime="2018-11-30T23:00" class="feed__date">
                                 November 30, 2018
                           </time>
                        </div>
                        <h3 class="h1">
                           <a href="https://itheo.tech/image-resize-python-automation-script.html">
                              Image resize python automation script
                           </a>
                        </h3>
                     </article>
                     <article class="related__item">
                        <div class="feed__meta">
                           <time datetime="2018-12-19T23:00" class="feed__date">
                                 December 19, 2018
                           </time>
                        </div>
                        <h3 class="h1">
                           <a href="https://itheo.tech/get-colors-from-images-python-script.html">
                              Get colors from images python script
                           </a>
                        </h3>
                     </article>
               </div>
            </div>



</main>
<footer class="footer">
        <div class="footer__copyright">
            <p>iTheo.Tech</p>
        </div>
        <button onclick="backToTopFunction()" id="backToTop" class="footer__bttop" aria-label="Back to top" title="Back to top">
            <svg>
                <use xlink:href="https://itheo.tech/assets/svg/svg-map.svg#toparrow"/>
            </svg>
        </button>

</footer>
</div>

<script defer src="https://itheo.tech/assets/js/scripts.min.js?v=f47c11534595205f20935f0db2a62a85"></script>

<script>window.publiiThemeMenuConfig={mobileMenuMode:'sidebar',animationSpeed:300,submenuWidth: 'auto',doubleClickTime:500,mobileMenuExpandableSubmenus:true,relatedContainerForOverlayMenuSelector:'.top'};</script>

    <script>        
        var images = document.querySelectorAll('img[loading]');
        for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                images[i].classList.add('is-loaded');
            } else {
                images[i].addEventListener('load', function () {
                    this.classList.add('is-loaded');
                }, false);
            }
        }
    </script>



</body>
</html>
