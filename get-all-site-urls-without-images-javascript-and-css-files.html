<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Get all site urls, without images, javascript and css files - iTheo.Tech</title><meta name="description" content="So the other day I created.... (with a bit of help) a script for me to get all site URLs and put them in a csv file. All urls containing non-ascii chars, underscores or capitals were put in a different file. But... I also got&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://itheo.tech/get-all-site-urls-without-images-javascript-and-css-files.html"><link rel="alternate" type="application/atom+xml" href="https://itheo.tech/feed.xml"><link rel="alternate" type="application/json" href="https://itheo.tech/feed.json"><meta property="og:title" content="Get all site urls, without images, javascript and css files"><meta property="og:image" content="https://itheo.tech/media/posts/69/07af72186ed06c0ae45d78094799503c.jpeg"><meta property="og:image:width" content="1600"><meta property="og:image:height" content="1200"><meta property="og:site_name" content="iTheo.Tech"><meta property="og:description" content="So the other day I created.... (with a bit of help) a script for me to get all site URLs and put them in a csv file. All urls containing non-ascii chars, underscores or capitals were put in a different file. But... I also got&hellip;"><meta property="og:url" content="https://itheo.tech/get-all-site-urls-without-images-javascript-and-css-files.html"><meta property="og:type" content="article"><link rel="stylesheet" href="https://itheo.tech/assets/css/style.css?v=6fbb1e8931a5afe843374fd67c192c86"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://itheo.tech/get-all-site-urls-without-images-javascript-and-css-files.html"},"headline":"Get all site urls, without images, javascript and css files","datePublished":"2023-04-05T05:22","dateModified":"2024-06-01T19:42","image":{"@type":"ImageObject","url":"https://itheo.tech/media/posts/69/07af72186ed06c0ae45d78094799503c.jpeg","height":1200,"width":1600},"description":"So the other day I created.... (with a bit of help) a script for me to get all site URLs and put them in a csv file. All urls containing non-ascii chars, underscores or capitals were put in a different file. But... I also got&hellip;","author":{"@type":"Person","name":"Theo van der Sluijs","url":"https://itheo.tech/authors/theo-van-der-sluijs/"},"publisher":{"@type":"Organization","name":"Theo van der Sluijs","logo":{"@type":"ImageObject","url":"https://itheo.tech/media/website/itheo.tech-500x125-logo.png","height":125,"width":500}}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript></head><body><div class="site-container"><header class="top" id="js-header"><a class="logo" href="https://itheo.tech/"><img src="https://itheo.tech/media/website/itheo.tech-500x125-logo.png" alt="iTheo.Tech" width="500" height="125"></a><div class="search"><div class="search__overlay js-search-overlay"><div class="search__overlay-inner"><button class="search__close js-search-close" aria-label="Close">Close</button></div></div><button class="search__btn js-search-btn" aria-label="Search"><svg role="presentation" focusable="false"><use xlink:href="https://itheo.tech/assets/svg/svg-map.svg#search"/></svg></button></div></header><main><article class="post"><div class="hero"><figure class="hero__image hero__image--overlay"><img src="https://itheo.tech/media/posts/69/07af72186ed06c0ae45d78094799503c.jpeg" srcset="https://itheo.tech/media/posts/69/responsive/07af72186ed06c0ae45d78094799503c-xs.webp 300w, https://itheo.tech/media/posts/69/responsive/07af72186ed06c0ae45d78094799503c-sm.webp 480w, https://itheo.tech/media/posts/69/responsive/07af72186ed06c0ae45d78094799503c-md.webp 768w, https://itheo.tech/media/posts/69/responsive/07af72186ed06c0ae45d78094799503c-lg.webp 1024w, https://itheo.tech/media/posts/69/responsive/07af72186ed06c0ae45d78094799503c-xl.webp 1360w, https://itheo.tech/media/posts/69/responsive/07af72186ed06c0ae45d78094799503c-2xl.webp 1600w" sizes="(max-width: 1600px) 100vw, 1600px" loading="eager" height="1200" width="1600" alt=""></figure><header class="hero__content"><div class="wrapper"><div class="post__meta"><time datetime="2023-04-05T05:22">April 5, 2023</time></div><h1>Get all site urls, without images, javascript and css files</h1><div class="post__meta post__meta--author"><img src="https://itheo.tech/media/website/64.png" loading="eager" height="512" width="512" class="post__author-thumb" alt="Theo van der Sluijs"> <a href="https://itheo.tech/authors/theo-van-der-sluijs/" class="feed__author">Theo van der Sluijs</a></div></div></header></div><div class="wrapper post__entry"><p>So the other day I created.... (with a bit of help) a script for me to get all site URLs and put them in a csv file. All urls containing non-ascii chars, underscores or capitals were put in a different file.</p><p>But... I also got images, javascript files and CSS files. I just wanted Urls.</p><p>So the assignment is:</p><blockquote><p>Write a python script that recursively checks a site and gives me all the URLs, put all the URLs in a CSV file called "all_urls.csv" and put the URLs with non-asscii characters or underscores or capitals in a CSV file named "wrong_urls.csv. No need to scan URLs that are outside the domain. Ask for a site domain with input when the scripts start. Skip images, javascript files, and stylesheet files.</p></blockquote><p>Now... before I hit enter, it came to me. I have to do some commenting and testing</p><p>So the assignment became</p><blockquote><p>Write a python script that recursively checks a site and gives me all the URLs, put all the URLs in a csv file called "all_urls.csv" and put the urls with non-asscii characters or underscores or capitals in a csv file named "wrong_urls.csv. No need to scan urls that are outside the domain. Ask for a site domain with input when the scripts start. Skip images, javascript files, and stylesheet files. Write some inline comments and a test script.</p></blockquote><p>And off we go!</p><p>To achieve this, you can use the 'requests' and 'BeautifulSoup' libraries to fetch and parse the HTML content of the domain. You can then collect all the URLs within the domain, excluding images, JavaScript files, and stylesheets, and write them to the respective CSV files based on their characteristics.</p><p>Before you proceed, make sure you have installed the required libraries by running:</p><pre><code class="lang-bash">pip install requests beautifulsoup4<restore-line-break></restore-line-break></code></pre><p>Here's the Python script for your requirement:</p><pre><code class="lang-python"><span class="hljs-keyword">import</span> requests<restore-line-break><span class="hljs-keyword">from</span> bs4 <span class="hljs-keyword">import</span> BeautifulSoup<restore-line-break><span class="hljs-keyword">import</span> csv<restore-line-break><span class="hljs-keyword">from</span> urllib.parse <span class="hljs-keyword">import</span> urljoin<restore-line-break><span class="hljs-keyword">import</span> re<restore-line-break><restore-line-break><span class="hljs-comment"># Recursively fetches all links within the domain</span><restore-line-break><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_all_links_recursive</span>(<span class="hljs-params">url, domain, visited=None</span>):</span><restore-line-break>    <span class="hljs-keyword">if</span> visited <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<restore-line-break>        visited = set()<restore-line-break><restore-line-break>    <span class="hljs-keyword">if</span> url <span class="hljs-keyword">in</span> visited:<restore-line-break>        <span class="hljs-keyword">return</span> visited<restore-line-break><restore-line-break>    visited.add(url)<restore-line-break><restore-line-break>    page = requests.get(url)<restore-line-break>    soup = BeautifulSoup(page.content, <span class="hljs-string">"html.parser"</span>)<restore-line-break><restore-line-break>    <span class="hljs-keyword">for</span> link <span class="hljs-keyword">in</span> soup.find_all(<span class="hljs-string">"a"</span>):<restore-line-break>        href = link.get(<span class="hljs-string">"href"</span>)<restore-line-break>        <span class="hljs-keyword">if</span> href <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> is_skipped_file(href):<restore-line-break>            abs_url = urljoin(domain, href)<restore-line-break>            <span class="hljs-keyword">if</span> abs_url.startswith(domain) <span class="hljs-keyword">and</span> abs_url <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> visited:<restore-line-break>                visited = get_all_links_recursive(abs_url, domain, visited)<restore-line-break><restore-line-break>    <span class="hljs-keyword">return</span> visited<restore-line-break><restore-line-break><span class="hljs-comment"># Checks if the URL contains non-ASCII characters, underscores, or uppercase characters</span><restore-line-break><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">is_wrong_url</span>(<span class="hljs-params">url</span>):</span><restore-line-break>    <span class="hljs-keyword">if</span> re.search(<span class="hljs-string">r"[^x00-x7F]|_|[A-Z]"</span>, url):<restore-line-break>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><restore-line-break>    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><restore-line-break><restore-line-break><span class="hljs-comment"># Checks if the URL corresponds to an image, JavaScript file, or stylesheet</span><restore-line-break><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">is_skipped_file</span>(<span class="hljs-params">url</span>):</span><restore-line-break>    ext = url.split(<span class="hljs-string">"."</span>)[<span class="hljs-number">-1</span>].lower()<restore-line-break>    <span class="hljs-keyword">return</span> ext <span class="hljs-keyword">in</span> (<span class="hljs-string">"jpg"</span>, <span class="hljs-string">"jpeg"</span>, <span class="hljs-string">"png"</span>, <span class="hljs-string">"gif"</span>, <span class="hljs-string">"svg"</span>, <span class="hljs-string">"js"</span>, <span class="hljs-string">"css"</span>)<restore-line-break><restore-line-break><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>():</span><restore-line-break>    <span class="hljs-comment"># Prompt user for domain URL</span><restore-line-break>    domain = input(<span class="hljs-string">"Enter the domain URL: "</span>)<restore-line-break><restore-line-break>    <span class="hljs-comment"># Recursively fetch all the links within the domain</span><restore-line-break>    all_links = get_all_links_recursive(domain, domain)<restore-line-break><restore-line-break>    all_urls = []<restore-line-break>    wrong_urls = []<restore-line-break><restore-line-break>    <span class="hljs-comment"># Classify URLs</span><restore-line-break>    <span class="hljs-keyword">for</span> link <span class="hljs-keyword">in</span> all_links:<restore-line-break>        <span class="hljs-keyword">if</span> is_wrong_url(link):<restore-line-break>            wrong_urls.append(link)<restore-line-break>        <span class="hljs-keyword">else</span>:<restore-line-break>            all_urls.append(link)<restore-line-break><restore-line-break>    <span class="hljs-comment"># Write URLs to 'all_urls.csv'</span><restore-line-break>    <span class="hljs-keyword">with</span> open(<span class="hljs-string">"all_urls.csv"</span>, <span class="hljs-string">"w"</span>, newline=<span class="hljs-string">""</span>) <span class="hljs-keyword">as</span> csvfile:<restore-line-break>        writer = csv.writer(csvfile)<restore-line-break>        writer.writerow([<span class="hljs-string">"URL"</span>])<restore-line-break>        <span class="hljs-keyword">for</span> url <span class="hljs-keyword">in</span> all_urls:<restore-line-break>            writer.writerow([url])<restore-line-break><restore-line-break>    <span class="hljs-comment"># Write wrong URLs to 'wrong_urls.csv'</span><restore-line-break>    <span class="hljs-keyword">with</span> open(<span class="hljs-string">"wrong_urls.csv"</span>, <span class="hljs-string">"w"</span>, newline=<span class="hljs-string">""</span>) <span class="hljs-keyword">as</span> csvfile:<restore-line-break>        writer = csv.writer(csvfile)<restore-line-break>        writer.writerow([<span class="hljs-string">"Wrong URL"</span>])<restore-line-break>        <span class="hljs-keyword">for</span> url <span class="hljs-keyword">in</span> wrong_urls:<restore-line-break>            writer.writerow([url])<restore-line-break><restore-line-break>    print(<span class="hljs-string">"CSV files created: all_urls.csv, wrong_urls.csv"</span>)<restore-line-break><restore-line-break><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:<restore-line-break>    main()<restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></code></pre><p>Creating tests for this script is a bit challenging since it involves web requests and the content of the web pages may change over time. However, you can create some basic tests for the helper functions <code>is_wrong_url</code> and <code>is_skipped_file</code>.</p><p>First, split the helper functions <code>is_wrong_url</code> and <code>is_skipped_file</code> from the main script into a separate Python file named <code>script_helpers.py</code>. Then, import these functions in the main script using:</p><pre><code class="lang-python"><span class="hljs-keyword">from</span> script_helpers <span class="hljs-keyword">import</span> is_wrong_url, is_skipped_file<restore-line-break></restore-line-break></code></pre><p>Next, create a new Python file named <code>test_script.py</code> and include the following test script using the <code>unittest</code> library:</p><pre><code class="lang-python"><span class="hljs-keyword">import</span> unittest<restore-line-break><span class="hljs-keyword">from</span> script_helpers <span class="hljs-keyword">import</span> is_wrong_url, is_skipped_file<restore-line-break><restore-line-break><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestScript</span>(<span class="hljs-params">unittest.TestCase</span>):</span><restore-line-break><restore-line-break>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test_is_wrong_url</span>(<span class="hljs-params">self</span>):</span><restore-line-break>        self.assertTrue(is_wrong_url(<span class="hljs-string">"https://example.com/Test_Url"</span>))<restore-line-break>        self.assertTrue(is_wrong_url(<span class="hljs-string">"https://example.com/テスト"</span>))<restore-line-break>        self.assertFalse(is_wrong_url(<span class="hljs-string">"https://example.com/test-url"</span>))<restore-line-break><restore-line-break>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test_is_skipped_file</span>(<span class="hljs-params">self</span>):</span><restore-line-break>        self.assertTrue(is_skipped_file(<span class="hljs-string">"https://example.com/image.jpg"</span>))<restore-line-break>        self.assertTrue(is_skipped_file(<span class="hljs-string">"https://example.com/script.js"</span>))<restore-line-break>        self.assertTrue(is_skipped_file(<span class="hljs-string">"https://example.com/styles.css"</span>))<restore-line-break>        self.assertFalse(is_skipped_file(<span class="hljs-string">"https://example.com/test-url"</span>))<restore-line-break><restore-line-break><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:<restore-line-break>    unittest.main()<restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></code></pre><p>To run the tests, execute the <code>test_script.py</code> file in the command line:</p><pre><code class="lang-bash">python test_script.py<restore-line-break></restore-line-break></code></pre><p>These tests will verify the functionality of the <code>is_wrong_url</code> and <code>is_skipped_file</code> functions by checking if they correctly identify wrong URLs and skipped files, respectively.</p><p>Please note that these tests only cover a small part of the script's functionality. Testing the <code>get_all_links_recursive</code> function is more complex due to its dependency on web requests and the dynamic nature of web page content. In practice, you might use a library like <code>httpretty</code> or <code>responses</code> to mock web requests and create tests for this function.</p></div><footer class="wrapper post__footer"><p class="post__last-updated">This article was updated on June 1, 2024</p><div class="post__share"></div><div class="post__bio bio"><img src="https://itheo.tech/media/website/64.png" loading="lazy" height="512" width="512" class="bio__avatar" alt="Theo van der Sluijs"><div><h3 class="bio__name"><a href="https://itheo.tech/authors/theo-van-der-sluijs/" rel="author">Theo van der Sluijs</a></h3></div></div></footer></article><nav class="post__nav"><div class="post__nav-inner"><div class="post__nav-prev"><svg width="1.041em" height="0.416em" aria-hidden="true"><use xlink:href="https://itheo.tech/assets/svg/svg-map.svg#arrow-prev"/></svg> <a href="https://itheo.tech/get-all-site-urls-with-python.html" class="post__nav-link" rel="prev"><span>Previous</span> Get all site urls with python</a></div><div class="post__nav-next"><a href="https://itheo.tech/get-screamingfrog-data-with-a-python-script.html" class="post__nav-link" rel="next"><span>Next</span> Get ScreamingFrog Data with a Python script </a><svg width="1.041em" height="0.416em" aria-hidden="true"><use xlink:href="https://itheo.tech/assets/svg/svg-map.svg#arrow-next"/></svg></div></div></nav><div class="post__related related"><div class="wrapper"><h2 class="h5 related__title">You should also read:</h2><article class="related__item"><div class="feed__meta"><time datetime="2019-01-02T23:00" class="feed__date">January 2, 2019</time></div><h3 class="h1"><a href="https://itheo.tech/send-files-with-gmail-using-a-python-script.html">Send files with Gmail using a python script</a></h3></article><article class="related__item"><div class="feed__meta"><time datetime="2019-01-12T23:00" class="feed__date">January 12, 2019</time></div><h3 class="h1"><a href="https://itheo.tech/repair-and-compress-pdf-files-with-python.html">Repair and compress PDF files with python</a></h3></article><article class="related__item"><div class="feed__meta"><time datetime="2020-02-03T07:56" class="feed__date">February 3, 2020</time></div><h3 class="h1"><a href="https://itheo.tech/local-month-name-in-jekyll-github-site.html">Local month name in Jekyll GitHub site</a></h3></article></div></div></main><footer class="footer"><div class="footer__copyright"><p>iTheo.Tech</p></div><button onclick="backToTopFunction()" id="backToTop" class="footer__bttop" aria-label="Back to top" title="Back to top"><svg><use xlink:href="https://itheo.tech/assets/svg/svg-map.svg#toparrow"/></svg></button></footer></div><script defer="defer" src="https://itheo.tech/assets/js/scripts.min.js?v=f47c11534595205f20935f0db2a62a85"></script><script>window.publiiThemeMenuConfig={mobileMenuMode:'sidebar',animationSpeed:300,submenuWidth: 'auto',doubleClickTime:500,mobileMenuExpandableSubmenus:true,relatedContainerForOverlayMenuSelector:'.top'};</script><script>var images = document.querySelectorAll('img[loading]');
        for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                images[i].classList.add('is-loaded');
            } else {
                images[i].addEventListener('load', function () {
                    this.classList.add('is-loaded');
                }, false);
            }
        }</script></body></html>